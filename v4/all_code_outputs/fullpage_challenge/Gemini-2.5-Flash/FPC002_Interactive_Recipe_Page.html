<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chocolate Lava Cakes Recipe</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom CSS for ingredient strikethrough and star rating */
        .ingredient-item.checked {
            text-decoration: line-through;
            opacity: 0.7;
        }

        /* Star Rating */
        .star-rating input[type="radio"] {
            /* Visually hide the radio buttons but keep them accessible */
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
            pointer-events: none; /* Prevent clicks on the hidden input */
        }

        .star-rating label {
            display: inline-block;
            cursor: pointer;
            font-size: 2rem; /* Adjust size as needed */
            color: #ccc; /* Default star color */
            padding: 0 2px;
            transition: color 0.2s ease-in-out;
        }

        .star-rating label:hover,
        .star-rating label:hover ~ label,
        .star-rating input[type="radio"]:checked ~ label {
            color: #ffc107; /* Gold color for selected/hovered stars */
        }

         /* Ensure focus indicator is visible for labels/stars */
        .star-rating label:focus-within {
            outline: 2px solid #007bff; /* Example focus outline */
            outline-offset: 2px;
        }

        /* Timer display styles */
        .timer-display-item {
            background-color: #fff;
            border: 1px solid #ccc;
            padding: 8px 12px;
            margin-bottom: 8px;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .timer-display-item button {
            margin-left: 10px;
            padding: 4px 8px;
            background-color: #dc3545;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .timer-display-item button:hover {
             background-color: #c82333;
        }
    </style>
</head>
<body class="bg-gray-100 font-sans leading-normal tracking-normal">

    <header class="bg-white shadow">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div>
                    <a href="#" class="text-xl font-bold text-gray-800 hover:text-gray-700">Recipe Central</a>
                </div>
                <nav>
                    <a href="#" class="text-gray-800 hover:text-gray-700 px-3 py-2">Home</a>
                    <a href="#" class="text-gray-800 hover:text-gray-700 px-3 py-2">Browse</a>
                    <a href="#" class="text-gray-800 hover:text-gray-700 px-3 py-2">About</a>
                </nav>
            </div>
        </div>
    </header>

    <main class="container mx-auto mt-8 px-6 py-8">
        <article class="bg-white p-6 rounded-lg shadow-md">
            <h1 class="text-4xl font-bold mb-4 text-gray-800" data-testid="recipe-title">Decadent Chocolate Lava Cakes</h1>

            <figure class="mb-6 rounded-lg overflow-hidden">
                <img src="https://images.unsplash.com/photo-1590083137061-b369b84537a9?q=80&w=1932&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="Two gooey chocolate lava cakes with powdered sugar and berries" class="w-full h-64 object-cover md:h-96" width="960" height="640">
                <figcaption class="sr-only">Two warm chocolate lava cakes with molten centers, dusted with powdered sugar and garnished with fresh berries.</figcaption>
            </figure>


            <section class="mb-6 text-gray-700">
                <p class="mb-4">Indulge in these rich and irresistible chocolate lava cakes. With a perfectly baked exterior and a warm, molten chocolate center, they are the ultimate dessert for any chocolate lover.</p>
                <div class="flex flex-wrap gap-4 text-sm">
                    <span><strong>Prep time:</strong> 15 minutes</span>
                    <span><strong>Cook time:</strong> 12-15 minutes</span>
                    <span><strong>Servings:</strong> 4</span>
                </div>
            </section>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <section class="md:col-span-2">
                    <h2 class="text-2xl font-semibold mb-4 text-gray-800">Ingredients</h2>
                    <ul class="list-none p-0 space-y-2" data-testid="ingredients-list">
                        <li class="ingredient-item bg-gray-50 p-3 rounded flex items-center gap-2">
                            <input type="checkbox" id="ingredient-1" class="form-checkbox h-5 w-5 text-blue-600 rounded focus:ring-blue-500">
                            <label for="ingredient-1" class="flex-grow text-gray-700">1/2 cup (1 stick) unsalted butter, plus more for ramekins</label>
                        </li>
                        <li class="ingredient-item bg-gray-50 p-3 rounded flex items-center gap-2">
                             <input type="checkbox" id="ingredient-2" class="form-checkbox h-5 w-5 text-blue-600 rounded focus:ring-blue-500">
                             <label for="ingredient-2" class="flex-grow text-gray-700">2 tbsp all-purpose flour, plus more for ramekins</label>
                        </li>
                         <li class="ingredient-item bg-gray-50 p-3 rounded flex items-center gap-2">
                             <input type="checkbox" id="ingredient-3" class="form-checkbox h-5 w-5 text-blue-600 rounded focus:ring-blue-500">
                             <label for="ingredient-3" class="flex-grow text-gray-700">4 oz bittersweet chocolate, chopped</label>
                        </li>
                         <li class="ingredient-item bg-gray-50 p-3 rounded flex items-center gap-2">
                             <input type="checkbox" id="ingredient-4" class="form-checkbox h-5 w-5 text-blue-600 rounded focus:ring-blue-500">
                             <label for="ingredient-4" class="flex-grow text-gray-700">1 1/2 cups powdered sugar</label>
                        </li>
                        <li class="ingredient-item bg-gray-50 p-3 rounded flex items-center gap-2">
                             <input type="checkbox" id="ingredient-5" class="form-checkbox h-5 w-5 text-blue-600 rounded focus:ring-blue-500">
                             <label for="ingredient-5" class="flex-grow text-gray-700">2 large eggs</label>
                        </li>
                         <li class="ingredient-item bg-gray-50 p-3 rounded flex items-center gap-2">
                             <input type="checkbox" id="ingredient-6" class="form-checkbox h-5 w-5 text-blue-600 rounded focus:ring-blue-500">
                             <label for="ingredient-6" class="flex-grow text-gray-700">2 egg yolks</label>
                        </li>
                         <li class="ingredient-item bg-gray-50 p-3 rounded flex items-center gap-2">
                             <input type="checkbox" id="ingredient-7" class="form-checkbox h-5 w-5 text-blue-600 rounded focus:ring-blue-500">
                             <label for="ingredient-7" class="flex-grow text-gray-700">1 tsp vanilla extract</label>
                        </li>
                         <li class="ingredient-item bg-gray-50 p-3 rounded flex items-center gap-2">
                             <input type="checkbox" id="ingredient-8" class="form-checkbox h-5 w-5 text-blue-600 rounded focus:ring-blue-500">
                             <label for="ingredient-8" class="flex-grow text-gray-700">Pinch of salt</label>
                        </li>
                         <li class="ingredient-item bg-gray-50 p-3 rounded flex items-center gap-2">
                             <input type="checkbox" id="ingredient-9" class="form-checkbox h-5 w-5 text-blue-600 rounded focus:ring-blue-500">
                             <label for="ingredient-9" class="flex-grow text-gray-700">Optional: Ice cream, berries, or whipped cream for serving</label>
                        </li>
                    </ul>
                </section>

                <section class="md:col-span-1">
                     <h2 class="text-2xl font-semibold mb-4 text-gray-800">Active Timers</h2>
                     <div id="recipe-timer-display" data-testid="recipe-timer-display" aria-live="polite" aria-atomic="false" class="space-y-2">
                         <!-- Timer instances will be injected here by JS -->
                         <p class="text-gray-600">No timers running.</p>
                     </div>
                </section>
            </div>


            <section class="mt-8">
                <h2 class="text-2xl font-semibold mb-4 text-gray-800">Instructions</h2>
                <ol class="list-decimal list-inside space-y-4 text-gray-700">
                    <li class="flex items-start gap-2">
                        <span class="flex-shrink-0">1.</span>
                        <span>Preheat oven to 425°F (220°C). Butter and flour four 6-ounce ramekins. Place ramekins on a baking sheet.</span>
                    </li>
                    <li class="flex items-start gap-2 instruction-step" data-step="2">
                        <span class="flex-shrink-0">2.</span>
                        <span class="flex-grow">In a medium saucepan, melt butter over low heat. Add chopped chocolate and stir until completely melted and smooth. Remove from heat and whisk in the powdered sugar until smooth. Stir in the flour.</span>
                    </li>
                    <li class="flex items-start gap-2 instruction-step" data-step="3">
                        <span class="flex-shrink-0">3.</span>
                        <span class="flex-grow">Whisk in the eggs and egg yolks one at a time until well combined. Stir in the vanilla extract and salt.</span>
                    </li>
                     <li class="flex items-start gap-2 instruction-step" data-step="4">
                        <span class="flex-shrink-0">4.</span>
                        <span class="flex-grow">Pour batter evenly into the prepared ramekins.</span>
                    </li>
                    <li class="flex items-start gap-2 instruction-step" data-step="5">
                         <span class="flex-shrink-0">5.</span>
                         <span class="flex-grow">Bake for 12 to 15 minutes, or until the sides are firm and the center is slightly soft (they will look slightly underdone).
                             <button data-duration-seconds="720" class="ml-2 px-3 py-1 bg-blue-500 text-white text-sm rounded hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50" data-testid="timer-btn-step5" aria-label="Start timer for 12 minutes">Start 12 min Timer</button>
                        </span>
                    </li>
                    <li class="flex items-start gap-2 instruction-step" data-step="6">
                         <span class="flex-shrink-0">6.</span>
                        <span class="flex-grow">Carefully invert each cake onto a serving plate. Let stand for 1 minute before serving. Dust with powdered sugar, if desired, and serve immediately with ice cream, berries, or whipped cream.</span>
                    </li>
                </ol>
            </section>

            <aside class="mt-8 p-6 bg-gray-50 rounded-lg shadow-sm">
                 <h2 class="text-2xl font-semibold mb-4 text-gray-800">Nutrition Information <span class="text-sm font-normal text-gray-600">(Approximate per serving)</span></h2>
                 <table class="min-w-full bg-white border border-gray-200 rounded-md">
                     <thead>
                         <tr class="bg-gray-100 border-b border-gray-200">
                             <th class="text-left py-3 px-4 font-semibold text-gray-600">Nutrient</th>
                             <th class="text-left py-3 px-4 font-semibold text-gray-600">Amount</th>
                         </tr>
                     </thead>
                     <tbody>
                         <tr>
                             <td class="py-3 px-4 border-b border-gray-200">Calories</td>
                             <td class="py-3 px-4 border-b border-gray-200">550</td>
                         </tr>
                         <tr>
                             <td class="py-3 px-4 border-b border-gray-200">Protein</td>
                             <td class="py-3 px-4 border-b border-gray-200">7g</td>
                         </tr>
                         <tr>
                             <td class="py-3 px-4 border-b border-gray-200">Fat</td>
                             <td class="py-3 px-4 border-b border-gray-200">35g</td>
                         </tr>
                         <tr>
                             <td class="py-3 px-4">Carbohydrates</td>
                             <td class="py-3 px-4">55g</td>
                         </tr>
                     </tbody>
                 </table>
            </aside>


            <section class="mt-8">
                <h2 class="text-2xl font-semibold mb-4 text-gray-800">User Reviews</h2>

                <!-- Placeholder for existing reviews -->
                <div class="mb-6">
                    <h3 class="text-xl font-semibold mb-3 text-gray-700">What Others Are Saying</h3>
                    <div class="space-y-4 text-gray-700 italic">
                        <p>No reviews yet. Be the first to share your experience!</p>
                        <!-- Example review structure -->
                        <!--
                        <div class="border p-4 rounded">
                            <div class="font-bold">Jane Doe <span class="text-yellow-500">★★★★★</span></div>
                            <p class="text-sm text-gray-600">Made these last night, they were absolutely divine!</p>
                        </div>
                         -->
                    </div>
                </div>

                <h3 class="text-xl font-semibold mb-3 text-gray-700">Leave a Review</h3>
                <form data-testid="review-form" class="space-y-4 p-6 bg-gray-50 rounded-lg shadow-sm">
                    <div>
                        <label for="reviewer-name" class="block text-sm font-medium text-gray-700">Name:</label>
                        <input type="text" id="reviewer-name" name="reviewerName" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2">
                    </div>

                    <div>
                         <label class="block text-sm font-medium text-gray-700 mb-1">Rating:</label>
                         <div class="star-rating" role="radiogroup" aria-label="Rating">
                             <input type="radio" id="star5" name="rating" value="5" aria-label="5 stars">
                             <label for="star5" title="5 stars">★</label>
                             <input type="radio" id="star4" name="rating" value="4" aria-label="4 stars">
                             <label for="star4" title="4 stars">★</label>
                             <input type="radio" id="star3" name="rating" value="3" aria-label="3 stars">
                             <label for="star3" title="3 stars">★</label>
                             <input type="radio" id="star2" name="rating" value="2" aria-label="2 stars">
                             <label for="star2" title="2 stars">★</label>
                             <input type="radio" id="star1" name="rating" value="1" aria-label="1 star">
                             <label for="star1" title="1 star">★</label>
                         </div>
                    </div>

                    <div>
                         <label for="review-comment" class="block text-sm font-medium text-gray-700">Comment:</label>
                         <textarea id="review-comment" name="reviewComment" rows="4" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2"></textarea>
                    </div>

                    <button type="submit" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500">
                        Submit Review
                    </button>
                </form>
            </section>

        </article>
    </main>

    <footer class="bg-gray-800 mt-8 py-6">
        <div class="container mx-auto px-6 text-center text-gray-400">
            <p>© 2023 Recipe Central. All rights reserved.</p>
        </div>
    </footer>

    <script>
        // Ingredient Checklist Functionality
        const ingredientList = document.querySelector('[data-testid="ingredients-list"]');
        if (ingredientList) {
            ingredientList.addEventListener('change', function(event) {
                if (event.target.type === 'checkbox') {
                    const listItem = event.target.closest('.ingredient-item');
                    if (listItem) {
                        if (event.target.checked) {
                            listItem.classList.add('checked');
                            // ARIA state for checkbox is handled natively
                        } else {
                            listItem.classList.remove('checked');
                        }
                    }
                }
            });
        }

        // Timer Functionality
        const timerDisplayArea = document.getElementById('recipe-timer-display');
        const timerButtons = document.querySelectorAll('[data-testid^="timer-btn-step"]');
        const activeTimers = {}; // Store active timers by a unique ID

        timerButtons.forEach(button => {
            button.addEventListener('click', function() {
                const durationSeconds = parseInt(this.dataset.durationSeconds, 10);
                if (isNaN(durationSeconds) || durationSeconds <= 0) {
                    console.error("Invalid timer duration specified:", this.dataset.durationSeconds);
                    return;
                }

                // Generate a unique ID for this timer instance
                const timerId = `timer-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;
                const stepElement = this.closest('.instruction-step');
                const stepNumber = stepElement ? stepElement.dataset.step : 'Unknown Step';

                // Prevent starting multiple timers from the same button (simple check)
                if(this.disabled) {
                    return;
                }

                // Disable the button while timer is active
                this.disabled = true;
                this.textContent = 'Timer Running...';


                // Create display element for this timer
                const timerItem = document.createElement('div');
                timerItem.classList.add('timer-display-item');
                timerItem.setAttribute('id', `timer-item-${timerId}`);
                timerItem.setAttribute('role', 'timer'); // Semantic role
                timerItem.setAttribute('aria-live', 'assertive'); // Important updates

                const timerLabel = document.createElement('span');
                timerLabel.textContent = `Step ${stepNumber} Timer: `;

                const timerValue = document.createElement('span');
                timerValue.classList.add('timer-value');
                timerValue.textContent = formatTime(durationSeconds);
                timerItem.appendChild(timerLabel);
                timerItem.appendChild(timerValue);

                const cancelButton = document.createElement('button');
                cancelButton.textContent = 'Cancel';
                cancelButton.setAttribute('aria-label', `Cancel timer for Step ${stepNumber}`);
                cancelButton.addEventListener('click', () => cancelTimer(timerId, this));
                timerItem.appendChild(cancelButton);


                // Remove "No timers running." message if present
                const noTimersMessage = timerDisplayArea.querySelector('p.text-gray-600');
                if(noTimersMessage) {
                    noTimersMessage.remove();
                }

                timerDisplayArea.appendChild(timerItem);

                let timeLeft = durationSeconds;
                const interval = setInterval(() => {
                    timeLeft--;
                    timerValue.textContent = formatTime(timeLeft);

                    if (timeLeft <= 0) {
                        clearInterval(interval);
                        timerValue.textContent = 'Finished!';
                        timerItem.style.backgroundColor = '#d4edda'; // Light green background
                        timerItem.style.borderColor = '#c3e6cb';
                        timerItem.classList.add('timer-finished'); // Add class for potential styling/selection
                        cancelButton.textContent = 'Done'; // Change button text

                        // Re-enable the start button after timer finishes
                        this.disabled = false;
                        this.textContent = this.getAttribute('aria-label').replace('Start timer for ', 'Start ').replace(' minutes', ' min Timer').replace(' seconds', ' sec Timer');


                        // Simple notification
                        alert(`Timer for Step ${stepNumber} is finished!`);

                         // Announce completion for screen readers
                         timerItem.setAttribute('aria-live', 'assertive'); // Ensure announcement
                         // Update text content after alert, potentially adding a completion phrase
                         timerLabel.textContent = `Step ${stepNumber} Timer: Finished!`;
                         timerItem.removeChild(timerValue); // Remove the countdown span


                    }
                }, 1000);

                activeTimers[timerId] = { interval: interval, button: this, itemElement: timerItem };
            });
        });

        function formatTime(seconds) {
            if (seconds < 0) return '0:00';
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            const paddedSeconds = remainingSeconds < 10 ? '0' + remainingSeconds : remainingSeconds;
            return `${minutes}:${paddedSeconds}`;
        }

        function cancelTimer(timerId, originalButton) {
            const timer = activeTimers[timerId];
            if (timer) {
                clearInterval(timer.interval);
                const timerItemElement = document.getElementById(`timer-item-${timerId}`);
                if (timerItemElement) {
                    timerItemElement.remove();
                }
                // Re-enable the original start button
                originalButton.disabled = false;
                originalButton.textContent = originalButton.getAttribute('aria-label').replace('Start timer for ', 'Start ').replace(' minutes', ' min Timer').replace(' seconds', ' sec Timer');

                delete activeTimers[timerId];

                // If no timers left, add the "No timers running" message back
                 if (Object.keys(activeTimers).length === 0) {
                     const noTimersMessage = document.createElement('p');
                     noTimersMessage.classList.add('text-gray-600');
                     noTimersMessage.textContent = 'No timers running.';
                     timerDisplayArea.appendChild(noTimersMessage);
                 }
            }
        }


        // Basic form submission (prevent default for demo)
        const reviewForm = document.querySelector('[data-testid="review-form"]');
        if (reviewForm) {
            reviewForm.addEventListener('submit', function(event) {
                event.preventDefault();
                // In a real application, you would collect form data and send it to a backend
                console.log('Review form submitted (prevented default). Data:', new FormData(event.target));
                alert('Review submitted! (Simulated)'); // Provide user feedback
                // Optionally clear the form: event.target.reset();
            });
        }

        // Star rating keyboard accessibility (using radio buttons handles this mostly)
        // Ensure labels have correct `for` attributes pointing to radio button IDs. Done in HTML.
        // Styling handles visual indication.
        // Browser handles focus and arrow key navigation for radio groups.

    </script>

</body>
</html>